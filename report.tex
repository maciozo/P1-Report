%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% EL/EEE D1 Report Template
% University of Southampton
%
% author : Rhys Thomas (rt8g15)
%
% edited : 2016-11-14
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\documentclass[a4paper,11pt]{article}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% PACKAGES
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usepackage[margin=1in]{geometry}
\renewcommand{\baselinestretch}{1.2} % line spacing
\usepackage{color}
\usepackage{siunitx}
\usepackage{graphicx}
\usepackage{epstopdf}
\usepackage{float}
\usepackage{pdfpages}
\usepackage{hyperref}
\usepackage{mathtools}
\usepackage{csvsimple}
\usepackage[titletoc,toc,title]{appendix}
\usepackage{pgfplots}
\usepackage{subfiles}
\usepackage{subfig}
\usepackage{textcomp}

\pgfplotsset{compat=1.13}
\pgfplotsset{unit code/.code={\si{#1}}}
\usepgfplotslibrary{units}

\graphicspath{ {./images/} }

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% DOCUMENT BEGIN
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{document}
  
\begin{center}
{\Large{\textbf{ELEC2201 P1 -- Solar cell research exercise}}} \\ [\baselineskip]
\subfile{info.tex}
\end{center}

\begin{abstract}
An investigation in to the effect of light intensity and cell temperature on the performance of a solar cell was carried out. It was found that increasing the intensity of the light would produce an exponential (as far as the range of results showed) increase in maximum output power. An increase in cell temperature produced an exponential decay in maximum output power.
\end{abstract}

\section{Aim}
The aim of this set of experiments was to measure and analyse the Current-Voltage characteristics of a solar cell, as well as its performance, and how it varies in different conditions that may arise in the real world.

The experimental setup included a tungsten lamp pointed at single solar cell, which is mounted on to a peltier cooler/heater.

\section{Hypothesis}
Three experiments were carried out to measure the IV characteristics of the solar cell. The first involved varying the series resistance of the cell from \SI{1}{\ohm}, to \SI{9999}{\ohm}. The expected result was that as the resistance increased, the voltage across the resistance would increase, and therefore the current would decrease following a typical solar cell IV curve, such as the one shown in figure \ref{fig:moduleIV}.

\begin{figure}[h]
    \centering
    \includegraphics{moduleIV.jpg}
    \caption{An example of an IV characteristic graph for a solar cell~\cite{moduleIV}.}
    \label{fig:moduleIV}
\end{figure}

The second experiment measured the output voltage of the solar cell at varying light intensities and series resistances. It was hypothesised that an increase in light intensity would increase the voltage across the cell. The intensity was varied by adjusting the distance between the light source and the cell.

The third experiment measured the output voltage of the solar cell at varying temperatures. The hypothesis was that as the temperature of the cell was increased, its output voltage would decrease, as shown by equation~\ref{eq:V_OC}. Increasing the temperature, $T$, would decrease the bandgap energy of the semiconductor, and the intrinsic carrier concentration, $n_{\textrm{i}}$, which would increase the saturation current, $I_0$, decreasing the open circuit voltage, $V_{\textrm{OC}}$~\cite{pveTemperature}.

\begin{equation} \label{eq:V_OC}
V_{OC} = \frac{nkT}{q}\ln{\left(\frac{I_L}{I_0} + 1\right)}
\end{equation}


\section{Results}
\subsection{Baseline data}

This was the simple experiment that involved measuring the voltage across a varying resistance. The light source was fixed at \SI{10}{\centi\metre}, and the cell was kept at a temperature of \SI{20.5}{\celsius}. Refer to figure~\ref{plot:baseline}.

\begin{figure}[h]
\centering
\begin{tikzpicture}
    \begin{axis}[
        width = 0.5\textwidth,
        height = 0.2\textheight,
        xlabel = {Voltage},
                x unit = \si{\volt},
                ylabel = {Current},
                y unit = \si{\ampere},
        grid = both
        ]
        \addplot table[x = Voltage, y = Current, col sep = comma]{./tables/baseline.csv};
    \end{axis}
\end{tikzpicture}
\caption{Scatter plot for the acquired baseline data, based on the data from Appendix~\ref{dat:baseline}}
\label{plot:baseline}
\end{figure}

\subsection{Varying light intensity}

The above experiment was repeated, but at various light intensities. The intensity was varied by adjusting the distance between the light source and the solar cell. Refer to figure~\ref{fig:distances}.

\begin{figure}[h]
\centering
    \subfloat[Subfigure 1 list of figures text][Light \SI{20}{\centi\metre} from cell (Appendix~\ref{dat:d20}).]{
        \begin{tikzpicture}
            \begin{axis}[
                width = 0.5\textwidth,
                height = 0.2\textheight,
                xlabel = {Voltage},
                x unit = \si{\volt},
                ylabel = {Current},
                y unit = \si{\ampere},
                grid = both
                ]
                \addplot table[x = Voltage, y = Current, col sep = comma]{./tables/distance20.csv};
            \end{axis}
        \end{tikzpicture}
        \label{plot:d20}
    }
    \subfloat[Subfigure 1 list of figures text][Light \SI{30}{\centi\metre} from cell (Appendix~\ref{dat:d30}).]{
        \begin{tikzpicture}
            \begin{axis}[
                width = 0.5\textwidth,
                height = 0.2\textheight,
                xlabel = {Voltage},
                x unit = \si{\volt},
                ylabel = {Current},
                y unit = \si{\ampere},
                grid = both
                ]
                \addplot table[x = Voltage, y = Current, col sep = comma]{./tables/distance30.csv};
            \end{axis}
        \end{tikzpicture}
        \label{plot:d30}
    }
    \qquad
    \subfloat[Subfigure 1 list of figures text][Light \SI{40}{\centi\metre} from cell (Appendix~\ref{dat:d40}).]{
        \begin{tikzpicture}
            \begin{axis}[
                width = 0.5\textwidth,
                height = 0.2\textheight,
                xlabel = {Voltage},
                x unit = \si{\volt},
                ylabel = {Current},
                y unit = \si{\ampere},
                grid = both
                ]
                \addplot table[x = Voltage, y = Current, col sep = comma]{./tables/distance40.csv};
            \end{axis}
        \end{tikzpicture}
        \label{plot:d40}
    }
    \subfloat[Subfigure 1 list of figures text][Light \SI{50}{\centi\metre} from cell (Appendix~\ref{dat:d50}).]{
        \begin{tikzpicture}
            \begin{axis}[
                width = 0.5\textwidth,
                height = 0.2\textheight,
                xlabel = {Voltage},
                x unit = \si{\volt},
                ylabel = {Current},
                y unit = \si{\ampere},
                grid = both
                ]
                \addplot table[x = Voltage, y = Current, col sep = comma]{./tables/distance50.csv};
            \end{axis}
        \end{tikzpicture}
        \label{plot:d50}
    }
    \caption{Scatter plots for varying light intensity.}
    \label{fig:distances}
\end{figure}

\subsection{Varying cell temperature}
The baseline experiment repeated, but with the solar cell at various kept at various temperatures. Refer to figure~\ref{fig:temperatures}.

\begin{figure}[h]
\centering
    \subfloat[Subfigure 1 list of figures text][Cell at \SI{25}{\celsius} (Appendix~\ref{dat:t25}).]{
        \begin{tikzpicture}
            \begin{axis}[
                width = 0.5\textwidth,
                height = 0.2\textheight,
                xlabel = {Voltage},
                x unit = \si{\volt},
                ylabel = {Current},
                y unit = \si{\ampere},
                grid = both
                ]
                \addplot table[x = Voltage, y = Current, col sep = comma]{./tables/temperature25.csv};
            \end{axis}
        \end{tikzpicture}
        \label{plot:t25}
    }
    \subfloat[Subfigure 1 list of figures text][Cell at \SI{30}{\celsius} (Appendix~\ref{dat:t30}).]{
        \begin{tikzpicture}
            \begin{axis}[
                width = 0.5\textwidth,
                height = 0.2\textheight,
                xlabel = {Voltage},
                x unit = \si{\volt},
                ylabel = {Current},
                y unit = \si{\ampere},
                grid = both
                ]
                \addplot table[x = Voltage, y = Current, col sep = comma]{./tables/temperature30.csv};
            \end{axis}
        \end{tikzpicture}
        \label{plot:t30}
    }
    \qquad
    \subfloat[Subfigure 1 list of figures text][Cell at \SI{35}{\celsius} (Appendix~\ref{dat:t35}).]{
        \begin{tikzpicture}
            \begin{axis}[
                width = 0.5\textwidth,
                height = 0.2\textheight,
                xlabel = {Voltage},
                x unit = \si{\volt},
                ylabel = {Current},
                y unit = \si{\ampere},
                grid = both
                ]
                \addplot table[x = Voltage, y = Current, col sep = comma]{./tables/temperature35.csv};
            \end{axis}
        \end{tikzpicture}
        \label{plot:t35}
    }
    \subfloat[Subfigure 1 list of figures text][Cell at \SI{40}{\celsius} (Appendix~\ref{dat:t40}).]{
        \begin{tikzpicture}
            \begin{axis}[
                width = 0.5\textwidth,
                height = 0.2\textheight,
                xlabel = {Voltage},
                x unit = \si{\volt},
                ylabel = {Current},
                y unit = \si{\ampere},
                grid = both
                ]
                \addplot table[x = Voltage, y = Current, col sep = comma]{./tables/temperature40.csv};
            \end{axis}
        \end{tikzpicture}
        \label{plot:t40}
    }
    \caption{Scatter plots for varying cell temperatures.}
    \label{fig:temperatures}
\end{figure}

\section{Analysis}

All of the results, except for one (Figure~\ref{plot:d50}), have a current spike as the voltage across the cell tends to zero. The reason for these spikes in unknows, and therefore have been ignored. We will instead consider the results as if the line started off flat at $V = 0$.

\subsection{Baseline}

From the graph (Figure~\ref{plot:baseline}), we can deduce that with the solar cell at \SI{20.5}{\celsius}, and the light source \SI{10}{\centi\metre} away from the cell, the open circuit voltage ($V_{\textrm{OC}}$) of the cell is \SI{0.535}{\volt}, and the short circuit current ($I_{\textrm{SC}}$) is roughly \SI{12}{\milli\ampere}. From the graph, we can estimate values for maximum power of \SI{0.411}{\volt} for $V_{\textrm{mp}}$, and \SI{9.56}{\milli\ampere} for $I_{\textrm{mp}}$, giving a maximum power of $P_{\textrm{max}} = V_{\textrm{mp}} I_{\textrm{mp}} = \SI{3.93}{\milli\watt}$.

\begin{equation} \label{eq:ff}
\textrm{FF} = \frac{I_{\textrm{mp}} V_{\textrm{mp}}}{I_{\textrm{SC}} V_{\textrm{OC}}}
\end{equation}

Using equation~\ref{eq:ff}, we can calculate the fill factor of the solar cell to be 0.612. Given an exposed cell area of \SI{1}{\centi\metre\squared}, and a light power density ($\rho$) of \SI{0.35}{\kilo\watt\per\metre\squared}, the power conversion efficiency ($\eta$) can be calculated.

\begin{displaymath}
P_{\textrm{in}} = \rho A
                = (350)(\num{1e-4})
                = \SI{35}{\milli\watt}
\end{displaymath}

\begin{displaymath}
\eta = \frac{P_{\textrm{max}}}{P_{\textrm{in}}}
     = \frac{3.93}{35}
     = 11.2\%
\end{displaymath}

This value is significantly lower than the 16.60\% quoted by the solar cell's datasheet~\cite[Appendix~B]{labNotes}. This could be due to unideal operating conditions, such as the lamp emitting a light spectrum that is not optimal for the specific cell used. The efficiency could also have been affected by having some of the cell covered up (to expose only \SI{1}{\centi\metre}). There could have also been some dust or dirt on the cell or lamp. The datasheet does not specify the temperature at which its values were calculated, so they could have been based on measurements made at a much lower temperature.

\subsection{Varying light intensity}
By measuring the IV characteristics of the cell at various light intensities and using an equation for an equivalent circuit representing the solar cell (equation~\ref{eq:solarCell}), we can obtain values for the dark saturation current ($I_0$) and the ideality factor ($n$). From the graphs in figure~\ref{fig:temperatures}, it is shown that increasing the distance between the light and the cell decreases both the open circuit voltage, and the closed circuit current.

\begin{equation} \label{eq:solarCell}
I = I_L - I_0 \left( \exp{\left(\frac{qV}{nkT}\right)} - 1 \right)
\end{equation}

\begin{figure}[h]
\centering
\begin{tikzpicture}
    \begin{axis}[
        width = 0.5\textwidth,
        height = 0.2\textheight,
        xlabel = {$V_{\mathrm{OC}}$},
        x unit = \si{\volt},
        ylabel = {$\ln{\left(I_{\mathrm{SC}}\right)}$},
        grid = both
        ]
        \addplot table[x = Voc, y = lnIsc, col sep = comma]{./tables/2b.csv};
    \end{axis}
\end{tikzpicture}
\caption{Plot of the natural logarithm of the short circuit current against a varying open circuit voltage.}
\label{plot:2b}
\end{figure}

\begin{equation} \label{eq:sc}
\textrm{At short circuit, }
V = 0 \implies I_{\mathrm{SC}} = I_{\mathrm{L}}
\end{equation}

\begin{equation} \label{eq:oc}
\textrm{At open circuit, }
I = 0 \implies I_{\mathrm{L}} = I_0 \left(\exp{\left(\frac{qV_{\mathrm{OC}}}{nkT}\right)} - 1 \right)
\end{equation}

Equating \ref{eq:sc} and \ref{eq:oc}, and after some manipulation

\begin{equation} \label{eq:intensityGradient}
\ln{\left(I_{\mathrm{SC}}\right)} = \frac{q}{nkT} V_{\mathrm{OC}} + \ln{(I_0)}
\end{equation}

Which is of the form $y = mx + c$. Using linear regression, we can find approximate values. $\frac{q}{nkT} \approx 15.72$, $\ln{(I_0)} \approx -12.87$. Therefore $I_0 \approx \SI{2.57}{\micro\ampere}$.

\begin{displaymath}
n \approx \frac{q}{15.72(kT)} \approx \frac{\num{1.602e-19}}{15.72(\num{1.381e-23})(293.65)} \approx 2.51
\end{displaymath}

\subsection{Varying cell temperature}
As per the hypothesis and equation~\ref{eq:V_OC}, increasing the temperature of the cell decreases its open circuit voltage.

\begin{figure}[h]
\centering
\begin{tikzpicture}
    \begin{axis}[
        width = 0.5\textwidth,
        height = 0.2\textheight,
        xlabel = {Temperature},
        x unit = \si{\celsius},
        ylabel = {Max Power},
        y unit = \si{\watt},
        grid = both
        ]
        \addplot table[x = Temperature, y = Power, col sep = comma]{./tables/3b.csv};
        \addplot [domain = 17:43, samples = 300, dashed]{0.00624370093193090000 * (x ^ (-0.15383077938430200000))};
    \end{axis}
\end{tikzpicture}
\caption{Graph comparing the maximum power output of the cell against its temperature, with trendline.}
\label{plot:tempPower}
\end{figure}

The trendline in figure~\ref{plot:tempPower} was estimated to be of the form:

\begin{equation} \label{eq:mpVTemp}
P_{\textrm{max}} = 0.0062437009319309(T-273.15)-0.153830779384302
\end{equation}


\section{Discussion}
The results indicate that it is beneficial to have solar cells as close as possible to their source of light. But this comes at the expense of having a lower maximum power. If the cell was to be installed in an extremely sunny location, then assuming a worst case scenario of the cell being heated to \SI{120}{\celsius}, using equation~\ref{eq:mpVTemp}, its maximum power output would be \SI{2.99}{\milli\watt} - approximately 76\% of the maximum power at \SI{20.5}{\celsius}. Whilst this is a significant drop in performance, the increase in incident power should be taken in to account. While for example Europe may be much cooler on average than Australia, most areas only receive around \SI{1400}{\kilo\watt\hour\per\metre\squared}~\cite{solarMapEur}, as opposed to most areas of Australia getting over \SI{2000}{\kilo\watt\hour\per\metre\squared}~\cite{solarMapAus}, most of which are very sparsely populated~\cite{ausPopulationMap}.

\section{Conclusion}
As expected, increasing the intensity of the light increased the maximum output power of the solar cell, but in most practical applications, this increase in power will also come with an increase in cell temperature, since it would be impractical to cool a large array of solar panels. Fortunately, while the decrease in efficiency is significant, the greater light intensity, and more sparsely populated land would make it more practical to create large installations in hotter areas.

\section{Evaluation}
Further analysis could have been carried out involving the thermal characteristics of solar panels, as well how these properties are affected by different encapsulation methods. This coupled with research in to variations in average sunlight hours and temperatures around the world could have been used to create a more accurate basis as to where the most efficient places on Earth for a solar panel array would be.

The effect of the light's incidence angle could have been investigated. Various encapsulation methods could be investigated here as well, as light will interact differently with surfaces depending on their refractive indexes and textures.

\begin{appendices}
    \label{appendix}
    \section{Baseline data}
    \label{dat:baseline}
        \csvautotabular{./tables/baseline.csv}
    
    \section{Varying light intensity - \SI{20}{\centi\metre}}
    \label{dat:d20}
        \csvautotabular{./tables/distance20.csv}
        
    \section{Varying light intensity - \SI{30}{\centi\metre}}
    \label{dat:d30}
        \csvautotabular{./tables/distance30.csv}
        
    \section{Varying light intensity - \SI{40}{\centi\metre}}
    \label{dat:d40}
        \csvautotabular{./tables/distance40.csv}
        
    \section{Varying light intensity - \SI{50}{\centi\metre}}
    \label{dat:d50}
        \csvautotabular{./tables/distance50.csv}
        
    \section{Varying cell temperature - \SI{25}{\celsius}}
    \label{dat:t25}
        \csvautotabular{./tables/temperature25.csv}
        
    \section{Varying cell temperature - \SI{30}{\celsius}}
    \label{dat:t30}
        \csvautotabular{./tables/temperature30.csv}
        
    \section{Varying cell temperature - \SI{35}{\celsius}}
    \label{dat:t35}
        \csvautotabular{./tables/temperature35.csv}
        
    \section{Varying cell temperature - \SI{40}{\celsius}}
    \label{dat:t40}
        \csvautotabular{./tables/temperature40.csv}
\end{appendices}

\bibliographystyle{IEEEtran}
% IEEEabrv abbreviates journal titles in accordance to IEEE standards 
\bibliography{mybib}

\end{document}